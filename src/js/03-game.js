/**
 * –ù–∞–ø–∏—à–∏ –ø—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –¥–ª—è —ñ–≥—Ä–æ–≤–æ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∞.
 * –î–ª—è –≤–∏—Ä—ñ—à–µ–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π –≥–æ—Ç–æ–≤—É —Ä–æ–∑–º—ñ—Ç–∫—É HTML —Ç–∞ –±–∞–∑–æ–≤—É —Å—Ç–∏–ª—ñ–∑–∞—Ü—ñ—é.
 *
 * –ü—ñ—Å–ª—è –Ω–∞—Ç–∏—Å–Ω–µ–Ω–Ω—è –Ω–∞ –∫–Ω–æ–ø–∫—É "Start game"
 * –≤ –∫–æ–∂–Ω–æ–º—É –≤—ñ–∫–æ–Ω—Ü—ñ –ø–æ —á–µ—Ä–∑—ñ –º–∞—î –∑'—è–≤–ª—è—Ç–∏—Å—å
 * —Å–º–∞–π–ª–∏–∫ –∑ –∑–∞—Ç—Ä–∏–º–∫–æ—é –≤ 1 —Å–µ–∫—É–Ω–¥—É ('ü§ë' –∞–±–æ 'üëø')
 *
 * –ü—ñ–¥ —á–∞—Å –æ–±—Ä–æ–±–∫–∏ –∫–æ–∂–Ω–æ–≥–æ –≤—ñ–∫–æ–Ω—Ü—è —Å—Ç–≤–æ—Ä–∏ –º–∞—Å–∏–≤ –∑ Promis-–∞–º–∏
 * –≤ —è–∫–æ–º—É –∫–æ–∂–µ–Ω –∑ –Ω–∏—Ö –±—É–¥–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –∑–∞ —Å–≤–æ—î –≤—ñ–∫–æ–Ω—Ü–µ,
 * –ø—ñ—Å–ª—è —á–æ–≥–æ –æ–±—Ä–æ–±–∏ –¥–∞–Ω–∏–π –º–∞—Å–∏–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É Promise.allSettled
 *
 * –ü—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ –≤—Å—ñ –≤—ñ–∫–æ–Ω—Ü—è –±—É–ª–∏ –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ
 * —â–æ–± —Å–∫—Ä—ñ–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∑–Ω–∞—á–∞–≤ —á–∏ –≥—Ä–∞–≤–µ—Ü—å –ø–µ—Ä–µ–º—ñ–≥, —á–∏ –Ω—ñ.
 * –Ø–∫—â–æ –≤ –∫–æ–∂–Ω–æ–º—É –≤—ñ–∫–æ–Ω—Ü—ñ –æ–¥–Ω–∞–∫–æ–≤–∏–π —Å–º–∞–π–ª–∏–∫ —Ü–µ –æ–∑–Ω–∞—á–∞—î —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–µ—Ä–µ–º—ñ–≥
 *
 * –í –ø–æ–ª–µ result –≤–∏–≤–æ–¥–∏—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —Å—Ç–∞—Ç—É—Å –≥—Ä–∏ ('Winner' –∞–±–æ 'Loser')
 *
 * –ü—ñ—Å–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –Ω–∞ –∫–Ω–æ–ø–∫—É "Start game"
 * –ø–æ–ª–µ –º–∞—î –æ—á–∏—â–∞—Ç–∏—Å—å, –∞ –≥—Ä–∞ –ø–æ—á–∏–Ω–∞—Ç–∏—Å—å –∑ –ø–æ—á–∞—Ç–∫—É.
 */

/*
    1. –≤—ñ—à–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ –ø–æ–¥—ñ–π –ø–æ –∫–ª—ñ–∫—É –Ω–∞ –∫–Ω–æ–ø–∫—É —Å—Ç–∞—Ä—Ç (–±–ª–æ–∫—É—î–º–æ –∫–Ω–æ–ø–∫—É –¥–æ –∫—ñ–Ω—Ü—è –≥—Ä–∏)
    2. –æ—Ç—Ä–∏–º—É—î–º–æ –º–∞—Å–∏–≤ –¥—ñ—Ç–µ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —ñ –∑–∞–ø—É—Å–∫–∞—î–º–æ –º–µ—Ç–æ–¥ map —è–∫–∏–π –∑—Ä–æ–±–∏—Ç—å –ø—Ä–æ–º—ñ—Å –ø—ñ–¥ –∫–æ–∂–µ–Ω —Å–ª–æ—Ç (–≤ –ø—Ä–æ–º—ñ—Å—ñ —Ä–∞–Ω–¥–æ–º–Ω–æ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç–∏ –π–æ–≥–æ –≤ —Å—Ç–∞–Ω —Ñ—É–ª—Ñ—ñ–ª–¥ ü§ë –∞–±–æ —Ä–µ–¥–∂–µ–∫—Ç–µ–¥ üëø)
    3. –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É allSettled —á–µ–∫–∞—î–º–æ –ø–æ–∫–∏ –≤–∏–∫–æ–Ω–∞—é—Ç—å—Å—è –≤—Å—ñ –ø—Ä–æ–º—ñ—Å–∏ —ñ –ø–æ—Ç—ñ–º –æ–±—Ä–æ–±–ª—é—î–º–æ –º–∞—Å–∏–≤ –≤–∏–∫–æ–Ω–∞–Ω–∏—Ö –ø—Ä–æ–º—ñ—Å—ñ–≤
    4. –ø–æ–∫–∞–∑—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–∂–Ω–æ–≥–æ —Å–ª–æ—Ç–∞ –∑ –∑–∞—Ç—Ä–∏–∫–æ—é –≤ 1 —Å–µ–∫—É–Ω–¥—É
    5. —Ä–æ–±–∏–º–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –Ω–∞ –ø–µ—Ä–µ–º–æ–∂—Ü—è: —è–∫—â–æ –≤—Å—ñ –ø—Ä–æ–º—ñ—Å–∏ –æ–¥–Ω–æ–≥–æ —Ç–∏–ø—É - –º–∏ –ø–µ—Ä–µ–º–æ–≥–ª–∏. –¢–æ–±—Ç–æ, —è–∫—â–æ –≤—Å—ñ –ø—Ä–æ–º—ñ—Å–∏ –≤ —Å—Ç–∞–Ω—ñ fullfilled, –∞–±–æ –≤—Å—ñ –ø—Ä–æ–º—ñ—Å–∏ –≤ —Å—Ç–∞–Ω—ñ rejected - –º–∏ –ø–µ—Ä–µ–º–æ–≥–ª–∏. –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥—É every
    6. —ñ —Ä–æ–∑–±–ª–æ–∫–æ–≤—É—î–º–æ –∫–Ω–æ–ø–∫—É
*/

const startBtn = document.querySelector('.start-btn');
const container = document.querySelector('.container');
const result = document.querySelector('.result');

startBtn.addEventListener('click', handleStartGame);

function handleStartGame(event) {
  //* step 1
  event.target.disabled = true;
  result.textContent = ''; // –æ—á–∏—â—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ñ–¥ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó –≥—Ä–∏

  //* step 2

  //   const pormises = [...container.children].map(
  //     () => new Promise((res, rej) => (Math.random() > 0.5 ? res('ü§ë') : rej('üëø')))
  //   );
  const pormises = [...container.children].map(() =>
    Math.random() > 0.5 ? Promise.resolve('ü§ë') : Promise.reject('üëø')
  );

  console.log(pormises);

  //* step 3
  Promise.allSettled(pormises).then(items => {
    console.log(items);
    //* step 4
    items.forEach((item, i) => {
      container.children[i].textContent = ''; // –æ—á–∏—â—É—î–º–æ –≤—Å—ñ —Å–ª–æ—Ç–∏ –≤—ñ–¥ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –≥—Ä–∏

      setTimeout(() => {
        container.children[i].textContent = item.value || item.reason;
      }, 1000 * (i + 1));
      /*
      1000 * (i + 1) - –¥–ª—è –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–∏—Ö –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω—å
      1. i = 0 -> 1000 * (0 + 1) -> 1000
      2. i = 1 -> 1000 * (1 + 1) -> 2000
      3. i = 2 -> 1000 * (2 + 1) -> 3000
        */
    });

    //* step 5
    const isWinner =
      items.every(({ status }) => status === 'fulfilled') ||
      items.every(({ status }) => status === 'rejected');

    //* step 6
    setTimeout(() => {
      event.target.disabled = false;
      result.textContent = isWinner ? 'Winner' : 'Loser';
    }, container.children.length * 1000);
    // container.children.length * 1000 -> 3 * 1000 -> 3000 -> –∑–∞—Ç—Ä–∏–º–∫–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö –±—É–¥–µ —Ä—ñ–≤–Ω–∞ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Å–ª–æ—Ç—ñ–≤, —É –Ω–∞—Å 3 —Å–ª–æ—Ç–∏ - –∑–Ω–∞—á–∏—Ç—å —ñ –∑–∞—Ç—Ä–∏–º–∫–∞ –±—É–¥–µ 3 —Å–µ–∫—É–Ω–¥–∏
  });
}
